function downloadDataUri(e){e.url||(e.url="http://download-data-uri.appspot.com/"),$('<form method="post" action="'+e.url+'" style="display:none"><input type="hidden" name="filename" value="'+e.filename+'"/><input type="hidden" name="data" value="'+e.data+'"/></form>').appendTo("body").submit().remove()}function drawTriangle(e,a,o,n,r,t,i){e.activate();var c=new paper.Path;c.fillColor=""===coresSecundarias?coresPrimarias[o%2]:coresSecundarias,c.fillColor.alpha=n;for(var s in a)c.add(new paper.Point(r+i/2*Math.sin(a[s]*Math.PI/3),t+i/2*Math.cos(a[s]*Math.PI/3)));return c.closed=!0,c.fullySelected=!1,e.view.draw(),c}var MAX_LAYER=10,MIN_LAYER=4,MIN_ALPHA=.2,MAX_ALPHA=.8,firstMillis=0,lastTime=0,coresPrimarias=["#2DBCB5","#CE2A1E"],coresSecundarias="",STATE={RAND:0,ANIMA:1,GRAD:2,CICLE:3},sState=STATE.RAND,nLayer,pointsList,dAlpha,tool;window.onload=function(){function e(){var e=$(location).attr("href");e=e.trim(),e=e.replace(/#/,"");var a=f.filter(":checked").data("dir"),o=m.val(),n=g.val(),r=b.val(),t=e+"embed.html?width="+n+"&type="+o+"&pos="+a+"&color="+r;return'<iframe src="'+t+'" scrolling="no" id="iframeLogo" width ="100%" height="100%" frameborder="0" ></iframe>'}function a(e){switch(e){case"branco":$("#divCanvas").css("background-color","#999999"),coresSecundarias="#FFFFFF";break;case"vermelho":coresSecundarias="#cd171e",$("#divCanvas").css("background-color","white");break;case"preto":coresSecundarias="#000000",$("#divCanvas").css("background-color","white");break;default:coresSecundarias="",$("#divCanvas").css("background-color","white")}if(""!==$("#nome-colaborador").val()){var a=jQuery.Event("keyup");a.keyCode=13,$("#nome-colaborador").trigger(a)}else $("#gerar-aleatorio").trigger("click")}function o(e,a){var o=e.view.center.x,n=e.view.center.y;e.project.clear(),t(e,o,n,e.view.size.width*(2-Math.sqrt(3)/2),a)}function n(e){var a=e.view.center.x,o=e.view.center.y;e.project.clear(),t(e,a,o,e.view.size.width*(2-Math.sqrt(3)/2))}function r(e,a){a.activate();var o=a.project.exportJSON();e.activate(),e.project.clear();var n=e.project.importJSON(o),r=64.494;n[0].fitBounds(new e.Rectangle(0,0,r,r)),n[0].bounds.x=e.view.bounds.x,n[0].bounds.y=e.view.bounds.y;var t=w.val();""!==t&&e.project.importSVG("includes/images/"+t+".svg",{expandShapes:!1,onLoad:function(a){var o=h.filter(":checked").data("dir"),i=a.bounds.width;a.bounds.width=p[o][t]*r,i/=a.bounds.width,a.bounds.height=a.bounds.height*(2-i),a.bounds.x=n[0].bounds.x+r*v[o][0],a.bounds.y=n[0].bounds.y+r*v[o][1],""!==coresSecundarias&&(a.fillColor=coresSecundarias),e.view.viewSize=e.project.activeLayer.bounds,e.view.update()}}),e.view.viewSize=e.project.activeLayer.bounds,e.view.update()}function t(e,a,o,n,r){e.activate(),c=[];var t,s=range(i.length);if(void 0===r||""===r){var d=random(MIN_LAYER,MAX_LAYER),l=MIN_ALPHA+Math.random()*(MAX_ALPHA-MIN_ALPHA);t=0;for(var u=0;d>u;u++){for(var v=s[random(s.length)];-1===i[v].indexOf(t)&&-1!==t;)v=s[random(s.length)];t=0===t?3:-1,s.splice(v,1),c.push(drawTriangle(e,i[v],u,l,a,o,n))}}else{var p=MIN_LAYER+r.length%(MAX_LAYER-MIN_LAYER),l=MIN_ALPHA+p/MAX_LAYER*(MAX_ALPHA-MIN_ALPHA);t=0;for(var u=0;p>u;u++){for(var f=r[u%r.length],v=f.charCodeAt(0)%s.length;-1===i[v].indexOf(t)&&-1!==t;)v=s[random(s.length)];t=0===t?3:-1,s.splice(v,1),c.push(drawTriangle(e,i[v],u,l,a,o,n))}}e.view.update()}var i,c=[];firstMillis=(new Date).getTime();var s=document.getElementById("logoCanvas1"),d=document.getElementById("finalCanvas"),l=new paper.PaperScope,u=new paper.PaperScope;l.setup(s),u.setup(d),i=k_combinations([0,1,2,3,4,5],3);var v={V:[.08360081601,1.1568374446],H:[1.0296105255,.2467870257]},p={V:{fs:.7245479534,"fs-company":1.6268051711},H:{fs:.791,"fs-security":1.788,"fs-learning":1.8146,"fs-insurance":2.0468,"fs-entertainment":2.9068,"fs-company":1.7802,"fs-assistance":2.2016}};$("#salvar").on("click",function(){u.activate(),downloadAsSVG()});var f=$("input[name=posicao-embed]"),m=$("#fs-type-embed"),g=$("#logoWidth"),h=$("input[name=posicao-download]"),w=$("#fs-type-save"),A=$("#color-type-save"),b=$("#color-type-embed");$("#gerar-aleatorio").on("click",function(){n(l),r(u,l)}),$("#gerar-aleatorio").trigger("click"),$("#embed-result").val(e()),f.on("change",function(){$("#embed-result").val(e())}),m.on("change",function(){$("#embed-result").val(e())}),A.on("change",function(){a(A.val())}),h.on("change",function(){r(u,l)}),w.on("change",function(){r(u,l)}),b.on("change",function(){$("#embed-result").val(e())}),g.on("change",function(){$("#embed-result").val(e())}),$("#gerar-nome").on("click",function(){var e=$("#nome-colaborador").val();e=noAccents(e),e=e.replace(/ /g,""),o(l,e),r(u,l)}),$("#nome-colaborador").keyup(function(e){13==e.keyCode&&$("#gerar-nome").click()})};var downloadAsSVG=function(e){if(!e){var a=new Date;e="fslogo-"+a.getHours()+a.getMinutes()+a.getSeconds()+".svg"}var o="data:image/svg+xml;base64,"+btoa(paper.project.exportSVG({asString:!0}));downloadDataUri({data:o,filename:e})};